{"ast":null,"code":"import _regeneratorRuntime from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import Header from\"../components/header/Header\";import{useLocation,useNavigate}from\"react-router-dom\";import{toast}from\"react-toastify\";import StatusToast from\"../components/StatusToast\";import axios from\"../api/axios\";import useAuth from\"../hooks/useAuth\";import{useEffect}from\"react\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddStock=function AddStock(){var navigate=useNavigate();var data=useLocation().state;console.log(data);var _useState=useState((data===null||data===void 0?void 0:data.product_id)||\"\"),_useState2=_slicedToArray(_useState,2),product=_useState2[0],setProduct=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),products=_useState4[0],setProducts=_useState4[1];var _useState5=useState((data===null||data===void 0?void 0:data.stock)||\"\"),_useState6=_slicedToArray(_useState5,2),stock=_useState6[0],setStock=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSubmit=_useState8[0],setIsSubmit=_useState8[1];var _useAuth=useAuth(),auth=_useAuth.auth;var addVendor=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var req_url,req,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!isSubmit){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setIsSubmit(true);if(!(!product||!stock)){_context.next=7;break;}document.forms[0].classList.add(\"was-validated\");setIsSubmit(false);return _context.abrupt(\"return\");case 7:_context.prev=7;if(data){req_url=\"/update\";}else{req_url=\"/add\";}req=axios.post(\"/admin/stocks\"+req_url,{id:data===null||data===void 0?void 0:data.id,productId:product,stock:stock},{headers:{authorization:\"Bearer \"+auth.token}});_context.next=12;return toast.promise(req,{pending:\"Adding Stock\",success:\"Stock \".concat(data?\"Updated\":\"Added\",\" Successfully!\"),error:\"Something went Wrong!\"});case 12:response=_context.sent;navigate(\"/stocks/list\");_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](7);console.log(_context.t0);case 19:_context.prev=19;setIsSubmit(false);return _context.finish(19);case 22:case\"end\":return _context.stop();}},_callee,null,[[7,16,19,22]]);}));return function addVendor(){return _ref.apply(this,arguments);};}();useEffect(function(){var fetchProducts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _response$data,response;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.get(\"/admin/products/list\",{headers:{authorization:\"Bearer \"+auth.token}});case 3:response=_context2.sent;console.log(response.data);(response===null||response===void 0?void 0:(_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.success)&&setProducts(response.data.products);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 11:case\"end\":return _context2.stop();}},_callee2,null,[[0,8]]);}));return function fetchProducts(){return _ref2.apply(this,arguments);};}();fetchProducts();},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{page:data?\"Update Stock\":\"Add Stock\"}),/*#__PURE__*/_jsx(\"section\",{className:\"content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-primary\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-header\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"needs-validation\",noValidate:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"full-name\",children:\"Product\"}),/*#__PURE__*/_jsxs(\"select\",{disabled:data?true:false,required:true,type:\"text\",className:\"form-control\",id:\"product\",value:product,onChange:function onChange(e){return setProduct(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Product\"},\"0\"),products.map(function(item){return/*#__PURE__*/_jsx(\"option\",{value:item.id,children:item.name},item.id);})]}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Product is Required!\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"stock\",children:\"Stock\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"stock\",placeholder:\"Enter Stock\",value:stock,required:true,onChange:function onChange(e){return setStock(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"invalid-feedback\",children:\"Stock is Required!\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-primary\",onClick:addVendor,children:\"Submit\"}),/*#__PURE__*/_jsx(StatusToast,{})]})]})]})})})})]});};export default AddStock;","map":{"version":3,"names":["useState","Header","useLocation","useNavigate","toast","StatusToast","axios","useAuth","useEffect","AddStock","navigate","data","state","console","log","product_id","product","setProduct","products","setProducts","stock","setStock","isSubmit","setIsSubmit","auth","addVendor","document","forms","classList","add","req_url","req","post","id","productId","headers","authorization","token","promise","pending","success","error","response","fetchProducts","get","e","target","value","map","item","name"],"sources":["W:/Codezesk/aermart/admin-frontend/src/pages/AddStock.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport Header from \"../components/header/Header\";\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport StatusToast from \"../components/StatusToast\";\r\nimport axios from \"../api/axios\";\r\nimport useAuth from \"../hooks/useAuth\";\r\nimport { useEffect } from \"react\";\r\nconst AddStock = () => {\r\n  const navigate = useNavigate();\r\n  const data = useLocation().state;\r\n  console.log(data);\r\n  const [product, setProduct] = useState(data?.product_id || \"\");\r\n  const [products, setProducts] = useState([]);\r\n  const [stock, setStock] = useState(data?.stock || \"\");\r\n  const [isSubmit, setIsSubmit] = useState(false);\r\n  const { auth } = useAuth();\r\n  const addVendor = async () => {\r\n    if (isSubmit) return;\r\n    setIsSubmit(true);\r\n    if (!product || !stock) {\r\n      document.forms[0].classList.add(\"was-validated\");\r\n      setIsSubmit(false);\r\n      return;\r\n    }\r\n    try {\r\n      let req_url;\r\n      if (data) {\r\n        req_url = \"/update\";\r\n      } else {\r\n        req_url = \"/add\";\r\n      }\r\n      const req = axios.post(\r\n        \"/admin/stocks\" + req_url,\r\n        {\r\n          id: data?.id,\r\n          productId: product,\r\n          stock: stock,\r\n        },\r\n        {\r\n          headers: { authorization: \"Bearer \" + auth.token },\r\n        }\r\n      );\r\n      const response = await toast.promise(req, {\r\n        pending: \"Adding Stock\",\r\n        success: `Stock ${data ? \"Updated\" : \"Added\"} Successfully!`,\r\n        error: \"Something went Wrong!\",\r\n      });\r\n      navigate(\"/stocks/list\");\r\n    } catch (err) {\r\n      console.log(err);\r\n    } finally {\r\n      setIsSubmit(false);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    const fetchProducts = async () => {\r\n      try {\r\n        const response = await axios.get(\"/admin/products/list\", {\r\n          headers: { authorization: \"Bearer \" + auth.token },\r\n        });\r\n        console.log(response.data);\r\n        response?.data?.success && setProducts(response.data.products);\r\n      } catch (err) {\r\n        console.error(err);\r\n      }\r\n    };\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <Header page={data ? \"Update Stock\" : \"Add Stock\"} />\r\n      <section className=\"content\">\r\n        <div className=\"row\">\r\n          <div className=\"col\">\r\n            <div className=\"card card-primary\">\r\n              <div className=\"card-header\">\r\n                {/* <h3 className=\"card-title\">Quick Example</h3> */}\r\n              </div>\r\n              <form className=\"needs-validation\" noValidate>\r\n                <div className=\"card-body\">\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"full-name\">Product</label>\r\n                    <select\r\n                      disabled={data ? true : false}\r\n                      required\r\n                      type=\"text\"\r\n                      className=\"form-control\"\r\n                      id=\"product\"\r\n                      value={product}\r\n                      onChange={(e) => setProduct(e.target.value)}\r\n                    >\r\n                      <option key=\"0\" value=\"\">\r\n                        Select Product\r\n                      </option>\r\n                      {products.map((item) => (\r\n                        <option key={item.id} value={item.id}>\r\n                          {item.name}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                    <div className=\"invalid-feedback\">Product is Required!</div>\r\n                  </div>\r\n                  <div className=\"form-group\">\r\n                    <label htmlFor=\"stock\">Stock</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control\"\r\n                      id=\"stock\"\r\n                      placeholder=\"Enter Stock\"\r\n                      value={stock}\r\n                      required\r\n                      onChange={(e) => setStock(e.target.value)}\r\n                    />\r\n                    <div className=\"invalid-feedback\">Stock is Required!</div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"card-footer\">\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"btn btn-primary\"\r\n                    onClick={addVendor}\r\n                  >\r\n                    Submit\r\n                  </button>\r\n                  <StatusToast />\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </>\r\n  );\r\n};\r\nexport default AddStock;\r\n"],"mappings":"wXAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,MAAOC,OAAM,KAAM,6BAA6B,CAChD,OAASC,WAAW,CAAEC,WAAW,KAAQ,kBAAkB,CAC3D,OAASC,KAAK,KAAQ,gBAAgB,CACtC,MAAOC,YAAW,KAAM,2BAA2B,CACnD,MAAOC,MAAK,KAAM,cAAc,CAChC,MAAOC,QAAO,KAAM,kBAAkB,CACtC,OAASC,SAAS,KAAQ,OAAO,CAAC,6IAClC,GAAMC,SAAQ,CAAG,QAAXA,SAAQ,EAAS,CACrB,GAAMC,SAAQ,CAAGP,WAAW,EAAE,CAC9B,GAAMQ,KAAI,CAAGT,WAAW,EAAE,CAACU,KAAK,CAChCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC,CACjB,cAA8BX,QAAQ,CAAC,CAAAW,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEI,UAAU,GAAI,EAAE,CAAC,wCAAvDC,OAAO,eAAEC,UAAU,eAC1B,eAAgCjB,QAAQ,CAAC,EAAE,CAAC,yCAArCkB,QAAQ,eAAEC,WAAW,eAC5B,eAA0BnB,QAAQ,CAAC,CAAAW,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAES,KAAK,GAAI,EAAE,CAAC,yCAA9CA,KAAK,eAAEC,QAAQ,eACtB,eAAgCrB,QAAQ,CAAC,KAAK,CAAC,yCAAxCsB,QAAQ,eAAEC,WAAW,eAC5B,aAAiBhB,OAAO,EAAE,CAAlBiB,IAAI,UAAJA,IAAI,CACZ,GAAMC,UAAS,4FAAG,iKACZH,QAAQ,iEACZC,WAAW,CAAC,IAAI,CAAC,CAAC,KACd,CAACP,OAAO,EAAI,CAACI,KAAK,0BACpBM,QAAQ,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC,CAChDN,WAAW,CAAC,KAAK,CAAC,CAAC,wDAKnB,GAAIZ,IAAI,CAAE,CACRmB,OAAO,CAAG,SAAS,CACrB,CAAC,IAAM,CACLA,OAAO,CAAG,MAAM,CAClB,CACMC,GAAG,CAAGzB,KAAK,CAAC0B,IAAI,CACpB,eAAe,CAAGF,OAAO,CACzB,CACEG,EAAE,CAAEtB,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEsB,EAAE,CACZC,SAAS,CAAElB,OAAO,CAClBI,KAAK,CAAEA,KACT,CAAC,CACD,CACEe,OAAO,CAAE,CAAEC,aAAa,CAAE,SAAS,CAAGZ,IAAI,CAACa,KAAM,CACnD,CAAC,CACF,wBACsBjC,MAAK,CAACkC,OAAO,CAACP,GAAG,CAAE,CACxCQ,OAAO,CAAE,cAAc,CACvBC,OAAO,iBAAW7B,IAAI,CAAG,SAAS,CAAG,OAAO,kBAAgB,CAC5D8B,KAAK,CAAE,uBACT,CAAC,CAAC,SAJIC,QAAQ,eAKdhC,QAAQ,CAAC,cAAc,CAAC,CAAC,iFAEzBG,OAAO,CAACC,GAAG,aAAK,CAAC,yBAEjBS,WAAW,CAAC,KAAK,CAAC,CAAC,qGAEtB,kBArCKE,UAAS,0CAqCd,CACDjB,SAAS,CAAC,UAAM,CACd,GAAMmC,cAAa,6FAAG,6MAEKrC,MAAK,CAACsC,GAAG,CAAC,sBAAsB,CAAE,CACvDT,OAAO,CAAE,CAAEC,aAAa,CAAE,SAAS,CAAGZ,IAAI,CAACa,KAAM,CACnD,CAAC,CAAC,QAFIK,QAAQ,gBAGd7B,OAAO,CAACC,GAAG,CAAC4B,QAAQ,CAAC/B,IAAI,CAAC,CAC1B,CAAA+B,QAAQ,SAARA,QAAQ,iCAARA,QAAQ,CAAE/B,IAAI,yCAAd,eAAgB6B,OAAO,GAAIrB,WAAW,CAACuB,QAAQ,CAAC/B,IAAI,CAACO,QAAQ,CAAC,CAAC,mFAE/DL,OAAO,CAAC4B,KAAK,cAAK,CAAC,qEAEtB,kBAVKE,cAAa,2CAUlB,CACDA,aAAa,EAAE,CACjB,CAAC,CAAE,EAAE,CAAC,CAEN,mBACE,wCACE,KAAC,MAAM,EAAC,IAAI,CAAEhC,IAAI,CAAG,cAAc,CAAG,WAAY,EAAG,cACrD,gBAAS,SAAS,CAAC,SAAS,uBAC1B,YAAK,SAAS,CAAC,KAAK,uBAClB,YAAK,SAAS,CAAC,KAAK,uBAClB,aAAK,SAAS,CAAC,mBAAmB,wBAChC,YAAK,SAAS,CAAC,aAAa,EAEtB,cACN,cAAM,SAAS,CAAC,kBAAkB,CAAC,UAAU,6BAC3C,aAAK,SAAS,CAAC,WAAW,wBACxB,aAAK,SAAS,CAAC,YAAY,wBACzB,cAAO,OAAO,CAAC,WAAW,UAAC,SAAO,EAAQ,cAC1C,gBACE,QAAQ,CAAEA,IAAI,CAAG,IAAI,CAAG,KAAM,CAC9B,QAAQ,MACR,IAAI,CAAC,MAAM,CACX,SAAS,CAAC,cAAc,CACxB,EAAE,CAAC,SAAS,CACZ,KAAK,CAAEK,OAAQ,CACf,QAAQ,CAAE,kBAAC6B,CAAC,QAAK5B,WAAU,CAAC4B,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,EAAC,wBAE5C,eAAgB,KAAK,CAAC,EAAE,UAAC,gBAEzB,EAFY,GAAG,CAEN,CACR7B,QAAQ,CAAC8B,GAAG,CAAC,SAACC,IAAI,qBACjB,eAAsB,KAAK,CAAEA,IAAI,CAAChB,EAAG,UAClCgB,IAAI,CAACC,IAAI,EADCD,IAAI,CAAChB,EAAE,CAEX,EACV,CAAC,GACK,cACT,YAAK,SAAS,CAAC,kBAAkB,UAAC,sBAAoB,EAAM,GACxD,cACN,aAAK,SAAS,CAAC,YAAY,wBACzB,cAAO,OAAO,CAAC,OAAO,UAAC,OAAK,EAAQ,cACpC,cACE,IAAI,CAAC,MAAM,CACX,SAAS,CAAC,cAAc,CACxB,EAAE,CAAC,OAAO,CACV,WAAW,CAAC,aAAa,CACzB,KAAK,CAAEb,KAAM,CACb,QAAQ,MACR,QAAQ,CAAE,kBAACyB,CAAC,QAAKxB,SAAQ,CAACwB,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,EAAC,EAC1C,cACF,YAAK,SAAS,CAAC,kBAAkB,UAAC,oBAAkB,EAAM,GACtD,GACF,cAEN,aAAK,SAAS,CAAC,aAAa,wBAC1B,eACE,IAAI,CAAC,QAAQ,CACb,SAAS,CAAC,iBAAiB,CAC3B,OAAO,CAAEtB,SAAU,UACpB,QAED,EAAS,cACT,KAAC,WAAW,IAAG,GACX,GACD,GACH,EACF,EACF,EACE,GACT,CAEP,CAAC,CACD,cAAehB,SAAQ"},"metadata":{},"sourceType":"module","externalDependencies":[]}