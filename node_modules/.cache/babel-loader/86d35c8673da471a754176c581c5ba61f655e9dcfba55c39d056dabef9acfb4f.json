{"ast":null,"code":"import _defineProperty from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"W:/Codezesk/aermart/admin-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import useAuth from\"../hooks/useAuth\";import{Link,useNavigate,useLocation,Navigate}from\"react-router-dom\";import axios from\"../api/axios\";import StatusToast from\"../components/StatusToast\";import{toast}from\"react-toastify\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _location$state,_location$state$from,_ref2;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isSubmit=_useState6[0],setIsSubmit=_useState6[1];var navigate=useNavigate();var location=useLocation();var from=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||\"/\";//function for calling login api.\nvar _useAuth=useAuth(),auth=_useAuth.auth,setAuth=_useAuth.setAuth;var signIn=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _response$data,loginpromise,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!isSubmit){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setIsSubmit(true);if(!(!email||!password)){_context.next=6;break;}setIsSubmit(false);return _context.abrupt(\"return\");case 6:_context.prev=6;loginpromise=axios.post(\"/admin/login\",{email:email,password:password});_context.t0=toast;_context.t1=loginpromise;_context.next=12;return loginpromise;case 12:_context.t2=_context.sent.data.message;_context.t3={success:_context.t2,error:\"Something went Wrong!\"};_context.next=16;return _context.t0.promise.call(_context.t0,_context.t1,_context.t3);case 16:response=_context.sent;if(response!==null&&response!==void 0&&(_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.token){setAuth({token:response.data.token,user:response.data.user});localStorage.setItem(\"token\",response.data.token);localStorage.setItem(\"user\",JSON.stringify(response.data.user));navigate(from,{replace:true});}_context.next=24;break;case 20:_context.prev=20;_context.t4=_context[\"catch\"](6);console.log(_context.t4);toast.error(\"Something went Wrong!\");case 24:_context.prev=24;setIsSubmit(false);return _context.finish(24);case 27:case\"end\":return _context.stop();}},_callee,null,[[6,20,24,27]]);}));return function signIn(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[auth!==null&&auth!==void 0&&auth.token?/*#__PURE__*/_jsx(Navigate,{to:\"/\",state:{from:location},replace:true}):\"\",/*#__PURE__*/_jsx(\"div\",{style:(_ref2={alignItems:\"center\",backgroundColor:\"#e9ecef\",display:\"flexbox\"},_defineProperty(_ref2,\"display\",\"flex\"),_defineProperty(_ref2,\"flexDirection\",\"column\"),_defineProperty(_ref2,\"height\",\"100vh\"),_defineProperty(_ref2,\"justifyContent\",\"center\"),_ref2),children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"login-logo\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Admin\"}),\"LTE\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body login-card-body\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"login-box-msg\",children:\"Sign in to start your session\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",className:\"form-control\",placeholder:\"Email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(\"div\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"span\",{className:\"fas fa-envelope\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",placeholder:\"Password\",value:password,autoComplete:\"true\",onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(\"div\",{className:\"input-group-text\",children:/*#__PURE__*/_jsx(\"span\",{className:\"fas fa-lock\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"icheck-primary\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"remember\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"remember\",children:\"Remember Me\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(e){signIn();},className:\"btn btn-primary btn-block\",children:\"Sign In\"})})]})]})]})})]})}),/*#__PURE__*/_jsx(StatusToast,{})]});};export default Login;","map":{"version":3,"names":["useState","useAuth","Link","useNavigate","useLocation","Navigate","axios","StatusToast","toast","Login","email","setEmail","password","setPassword","isSubmit","setIsSubmit","navigate","location","from","state","pathname","auth","setAuth","signIn","loginpromise","post","data","message","success","error","promise","response","token","user","localStorage","setItem","JSON","stringify","replace","console","log","alignItems","backgroundColor","display","e","target","value"],"sources":["W:/Codezesk/aermart/admin-frontend/src/pages/Login.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport useAuth from \"../hooks/useAuth\";\r\nimport { Link, useNavigate, useLocation, Navigate } from \"react-router-dom\";\r\nimport axios from \"../api/axios\";\r\nimport StatusToast from \"../components/StatusToast\";\r\nimport { toast } from \"react-toastify\";\r\nconst Login = () => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [isSubmit, setIsSubmit] = useState(false);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const from = location.state?.from?.pathname || \"/\";\r\n  //function for calling login api.\r\n  const { auth, setAuth } = useAuth();\r\n  const signIn = async () => {\r\n    if (isSubmit) return;\r\n    setIsSubmit(true);\r\n    if (!email || !password) {\r\n      setIsSubmit(false);\r\n      return;\r\n    }\r\n    try {\r\n      const loginpromise = axios.post(\"/admin/login\", {\r\n        email: email,\r\n        password: password,\r\n      });\r\n      const response = await toast.promise(loginpromise, {\r\n        success: (await loginpromise).data.message,\r\n        error: \"Something went Wrong!\",\r\n      });\r\n      if (response?.data?.token) {\r\n        setAuth({ token: response.data.token, user: response.data.user });\r\n        localStorage.setItem(\"token\", response.data.token);\r\n        localStorage.setItem(\"user\", JSON.stringify(response.data.user));\r\n        navigate(from, { replace: true });\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n      toast.error(\"Something went Wrong!\");\r\n    } finally {\r\n      setIsSubmit(false);\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      {auth?.token ? (\r\n        <Navigate to=\"/\" state={{ from: location }} replace />\r\n      ) : (\r\n        \"\"\r\n      )}\r\n      <div\r\n        style={{\r\n          alignItems: \"center\",\r\n          backgroundColor: \"#e9ecef\",\r\n          display: \"flexbox\",\r\n          display: \"flex\",\r\n          flexDirection: \"column\",\r\n          height: \"100vh\",\r\n          justifyContent: \"center\",\r\n        }}\r\n      >\r\n        <div className=\"login-box\">\r\n          <div className=\"login-logo\">\r\n            <b>Admin</b>LTE\r\n          </div>\r\n          <div className=\"card\">\r\n            <div className=\"card-body login-card-body\">\r\n              <p className=\"login-box-msg\">Sign in to start your session</p>\r\n\r\n              <form>\r\n                <div className=\"input-group mb-3\">\r\n                  <input\r\n                    type=\"email\"\r\n                    className=\"form-control\"\r\n                    placeholder=\"Email\"\r\n                    value={email}\r\n                    onChange={(e) => setEmail(e.target.value)}\r\n                  />\r\n                  <div className=\"input-group-append\">\r\n                    <div className=\"input-group-text\">\r\n                      <span className=\"fas fa-envelope\"></span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"input-group mb-3\">\r\n                  <input\r\n                    type=\"password\"\r\n                    className=\"form-control\"\r\n                    placeholder=\"Password\"\r\n                    value={password}\r\n                    autoComplete=\"true\"\r\n                    onChange={(e) => setPassword(e.target.value)}\r\n                  />\r\n                  <div className=\"input-group-append\">\r\n                    <div className=\"input-group-text\">\r\n                      <span className=\"fas fa-lock\"></span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"row\">\r\n                  <div className=\"col-8\">\r\n                    <div className=\"icheck-primary\">\r\n                      <input type=\"checkbox\" id=\"remember\" />\r\n                      <label htmlFor=\"remember\">Remember Me</label>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col-4\">\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={(e) => {\r\n                        signIn();\r\n                      }}\r\n                      className=\"btn btn-primary btn-block\"\r\n                    >\r\n                      Sign In\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </form>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <StatusToast />\r\n    </>\r\n  );\r\n};\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}